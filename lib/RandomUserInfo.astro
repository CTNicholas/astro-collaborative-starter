<script>
  (() => {
    if (!window.LiveblocksRoom) {
      console.error('LiveblocksRoom not found')
      return
    }

    setup()

    if (import.meta.hot) {
      import.meta.hot.on('vite:beforeUpdate', () => {
        setTimeout(() => {
          setup()
        }, 1500)
      })
    }

    function setup () {
      window.LiveblocksRoom.setUser({
        name: randomName(),
        color: randomColor(),
        picture: randomPicture(),
        status: randomStatus()
      })

      // Functions for selecting random info
      function randomName () {
        const names = [
          'Alfred',
          'Becca',
          'Christine',
          'Declan',
          'Eduardo',
          'Faye',
          'Gregg',
          'Harriet',
          'Indira',
          'James',
          'Kimberley',
          'Leonardo'
        ]
        return names[Math.floor(Math.random() * names.length)]
      }

      function randomColor () {
        const colors = [
          '#dc2626',
          '#ea580c',
          '#d97706',
          '#ca8a04',
          '#65a30d',
          '#16a34a',
          '#059669',
          '#0d9488',
          '#0891b2',
          '#0284c7',
          '#2563eb',
          '#4f46e5',
          '#7c3aed',
          '#9333ea',
          '#c026d3',
          '#db2777',
          '#e11d48'
        ]
        return colors[Math.floor(Math.random() * colors.length)]
      }

      // `/public/avatars/X.png` or placeholder
      function randomPicture () {
        return Math.random() > 0.4 ? `/avatars/${Math.floor(Math.random() * 10)}.png` : ''
      }

      function randomStatus () {
        const statuses = [
          'Online',
          'Busy',
          'Away',
          'On Holiday',
          'Partying',
          'Working',
          'Studying',
          'Available',
          'Collaborating',
          'In a call'
        ]
        return statuses[Math.floor(Math.random() * statuses.length)]
      }
    }
  })()
</script>
